<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.web.gallery.dao.galleryDao">
	<insert id="addArtistGallery" parameterType="gallery">
		INSERT INTO
		gallery(gallery_name, gallery_desc, gallery_artistId, gallery_mainWorkId)
		VALUES (#{gallery_name}, #{gallery_desc}, #{gallery_artistId}, #{gallery_mainWorkId})
	</insert>

	<insert id="addArtistGalleryDetail" parameterType="list">
			INSERT INTO
			gallerydetail(galleryDetail_galleryId, galleryDetail_workId)
			VALUES
			<foreach collection="list" index="index" item="gallery_workId" separator=",">
			       ((SELECT gallery_id FROM gallery WHERE gallery_mainWorkId = #{list[0]}), #{gallery_workId})
			</foreach>

	</insert>

	<update id="modifyArtistGallery" parameterType="gallery">
		UPDATE gallery
		SET gallery_name = #{gallery_name},
		    gallery_desc = #{gallery_desc},
		    gallery_mainWorkId = #{gallery_mainWorkId}
		WHERE gallery_id = #{gallery_id}
	</update>

	<delete id="deleteArtistGalleryDetail" parameterType="int">
		DELETE FROM gallerydetail
		WHERE gallerydetail_galleryId = #{gallery_id}
	</delete>

	<delete id="deleteArtistGallery" parameterType="int">
		DELETE FROM gallery
		WHERE gallery_id = #{gallery_id}
	</delete>

	<select id="getGallery" parameterType="int" resultType="gallery">
		SELECT * FROM gallery
		WHERE gallery_id = #{gallery_id}
	</select>

	<select id="getAllMainGallery" resultType="gallery">
		SELECT * FROM gallery
		WHERE gallery_id
			IN (SELECT mainGallery_galleryId FROM maingallery)
	</select>

	<delete id="deleteGalleryToMainGallery" parameterType="int">
		DELETE FROM maingallery
		WHERE mainGallery_galleryId = #{mainGallery_galleryId}
	</delete>

	<select id="getAllSubGallery" resultType="work">
		SELECT * FROM work
		WHERE work_id
				  IN (SELECT subGallery_workId FROM subgallery)
	</select>

	<delete id="deleteWorkToSubGallery" parameterType="int">
		DELETE FROM subgallery
		WHERE subGallery_workId = #{subGallery_workId}
	</delete>

	<select id="getArtistGallery" parameterType="int" resultType="work">
		SELECT * FROM work
		WHERE work_id
		IN (SELECT galleryDetail_workId
			FROM gallerydetail
		    WHERE galleryDetail_galleryId = #{galleryDetail_galleryId})
	</select>

	<select id="getMyGallery" parameterType="String" resultType="gallery">
		SELECT * FROM gallery
		WHERE gallery_artistId = #{gallery_artistId}
	</select>

	<insert id="giveFootPrintToGallery" parameterType="hashmap">
		INSERT INTO footprint
		VALUES(#{footPrint_galleryId},#{footPrint_userId})
	</insert>

	<select id="getAdultGallery" resultType="work">
		select work_id
		from work
		where work_rating >= 19
	</select>

</mapper>